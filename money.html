<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pokladna</title>
    <style>
        /* Styling for the POS system */
        body {
            font-family: Arial, sans-serif;
            background: linear-gradient(to right, #ece9e6, #ffffff);
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            color: #333;
        }

        .container {
            display: flex;
            justify-content: space-between;
            flex-wrap: wrap;
            width: 90%;
            max-width: 1200px;
            margin: 20px;
        }

        .form-container, .table-container {
            background-color: #fff;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0px 3px 3px 3px rgba(0.1, 0.1, 0.1, 0.1);
            margin: 20px 10px;
            flex: 1;
            min-width: 300px;
        }

        .form-container h1, .table-container h1 {
            text-align: center;
            margin-bottom: 20px;
            font-size: 2em;
            color: #003757;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-size: 1.2em;
        }

        input {
            width: 100%;
            padding: 12px;
            box-sizing: border-box;
            border: 1px solid #ccc;
            border-radius: 6px;
            font-size: 1.2em;
        }

        button {
            width: 100%;
            padding: 15px;
            background-color: #003757;
            color: #fff;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 1.2em;
            transition: background-color 0.3s;
        }

        button:hover {
            background-color: #002740;
        }

        .result {
            margin-top: 30px;
            text-align: center;
        }

        .result span {
            font-weight: bold;
            font-size: 1.5em;
        }

        table {
            width: 100%;
            margin-top: 20px;
            border-collapse: collapse;
        }

        th, td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: center;
        }

        th {
            background-color: #003757;
            color: white;
        }

        td {
            background-color: #f9f9f9;
        }

        input[type="number"] {
            width: 80px;
            padding: 5px;
            border: 1px solid #ddd;
            border-radius: 4px;
            text-align: center;
            font-size: 1em;
        }

        input[type="number"]:focus {
            outline: none;
            border-color: #003757;
            box-shadow: 0 0 5px rgba(76, 111, 175, 0.5);
        }

        #grandTotal {
            margin-top: 20px;
            font-size: 1.8em;
            text-align: center;
            color: #003757;
            font-weight: bold;
            padding: 10px;
            border-radius: 8px;
            background-color: #fff;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

    
    </style>
</head>
<body>
     <div class="container">
        <div class="form-container">
            <h1>Pokladna</h1>
            <div class="form-group">
                <label for="amountDue">Částka k zaplacení:</label>
                <input type="number" id="amountDue" placeholder="Zadejte částku">
            </div>
            <div class="form-group">
                <label for="amountGiven">Peníze od zákazníka:</label>
                <input type="number" id="amountGiven" placeholder="Zadejte částku">
            </div>
            <button onclick="calculateChangeAndSave()">Vypočítat</button>
            <div class="result">
                <p>Vrácená částka: <span id="change"></span></p>
            </div>
        </div>

        <div class="table-container">
            <h1>Počítání peněz</h1>
            <table id="moneyTable">
                <thead>
                    <tr>
                        <th>Hodnota</th>
                        <th>Množství</th>
                        <th>Celkem</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>5000</td>
                        <td><input type="number" min="0" oninput="calculateTotal()"></td>
                        <td class="totalCell">0</td>
                    </tr>
                    <tr>
                        <td>2000</td>
                        <td><input type="number" min="0" oninput="calculateTotal()"></td>
                        <td class="totalCell">0</td>
                    </tr>
                    <tr>
                        <td>1000</td>
                        <td><input type="number" min="0" oninput="calculateTotal()"></td>
                        <td class="totalCell">0</td>
                    </tr>
                    <tr>
                        <td>500</td>
                        <td><input type="number" min="0" oninput="calculateTotal()"></td>
                        <td class="totalCell">0</td>
                    </tr>
                    <tr>
                        <td>200</td>
                        <td><input type="number" min="0" oninput="calculateTotal()"></td>
                        <td class="totalCell">0</td>
                    </tr>
                    <tr>
                        <td>100</td>
                        <td><input type="number" min="0" oninput="calculateTotal()"></td>
                        <td class="totalCell">0</td>
                    </tr>
                    <tr>
                        <td>50</td>
                        <td><input type="number" min="0" oninput="calculateTotal()"></td>
                        <td class="totalCell">0</td>
                    </tr>
                    <tr>
                        <td>20</td>
                        <td><input type="number" min="0" oninput="calculateTotal()"></td>
                        <td class="totalCell">0</td>
                    </tr>
                    <tr>
                        <td>10</td>
                        <td><input type="number" min="0" oninput="calculateTotal()"></td>
                        <td class="totalCell">0</td>
                    </tr>
                    <tr>
                        <td>5</td>
                        <td><input type="number" min="0" oninput="calculateTotal()"></td>
                        <td class="totalCell">0</td>
                    </tr>
                    <tr>
                        <td>2</td>
                        <td><input type="number" min="0" oninput="calculateTotal()"></td>
                        <td class="totalCell">0</td>
                    </tr>
                    <tr>
                        <td>1</td>
                        <td><input type="number" min="0" oninput="calculateTotal()"></td>
                        <td class="totalCell">0</td>
                    </tr>
                </tbody>
            </table>
            <div id="grandTotal">Celkový součet: 0</div>
            <button onclick="resetQuantities()">Vymazat</button>
        </div>
    </div>

    <script>
        // Function to calculate change in POS and
        // Function to calculate change in POS and save transaction history
        function calculateChangeAndSave() {
            var amountDue = parseFloat(document.getElementById('amountDue').value);
            var amountGiven = parseFloat(document.getElementById('amountGiven').value);

            if (isNaN(amountDue) || isNaN(amountGiven)) {
                alert('Prosím zadejte platnou částku.');
                return;
            }

            var change = amountGiven - amountDue;

            if (change < 0) {
                alert('Zákazník nedal dost peněz.');
            } else {
                document.getElementById('change').innerText = change.toFixed(2) + ' Kč';
                var note = prompt('Přidat poznámku (nepovinné):');
                saveTransaction(amountDue, amountGiven, change.toFixed(2), note);
            }
        }

        // Function to save transaction to localStorage
        function saveTransaction(amountDue, amountGiven, change, note) {
            var transaction = {
                amountDue: amountDue,
                amountGiven: amountGiven,
                change: change,
                note: note || "", // Handle cases where note might be null or undefined
                timestamp: new Date().toLocaleString()
            };

            var transactions = JSON.parse(localStorage.getItem('transactions')) || [];
            transactions.push(transaction);
            localStorage.setItem('transactions', JSON.stringify(transactions));

            // Add transaction to history table on history.html
            if (window.location.pathname.includes("history.html")) {
                addTransactionToHistory(transaction);
            }
        }

        // Function to calculate total amount in money table
        function calculateTotal() {
            var totalCells = document.querySelectorAll('.totalCell');
            var grandTotal = 0;

            totalCells.forEach(function(cell) {
                var input = cell.previousElementSibling.querySelector('input');
                var quantity = parseInt(input.value) || 0;
                var value = parseInt(cell.previousElementSibling.previousElementSibling.textContent);
                var total = quantity * value;
                cell.textContent = total;
                grandTotal += total;
            });

            document.getElementById('grandTotal').textContent = 'Celkový součet: ' + grandTotal;
        }

        // Function to reset quantities in money table
        function resetQuantities() {
            var inputs = document.querySelectorAll('#moneyTable input[type="number"]');
            inputs.forEach(function(input) {
                input.value = '';
            });

            calculateTotal();
        }

        // Load transaction history from localStorage on page load
        document.addEventListener('DOMContentLoaded', function() {
            var transactions = JSON.parse(localStorage.getItem('transactions')) || [];
            transactions.forEach(function(transaction) {
                addTransactionToHistory(transaction);
            });
        });

    </script>
</body>
</html>
